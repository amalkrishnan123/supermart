{% extends "navbar.html" %}

{% block username %}
<div class="ms-auto text-end">
    <h2 class="text-white mb-0">
        HELLO {{ request.user.username|upper }}
    </h2>
</div>
{% endblock username %}

{% block content %}
<style>
.cart-wrapper {
    max-width: 600px;
    margin: 40px auto;
}
.cart-card {
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 20px;
}
.fixed-img {
    height: 220px;
    object-fit: contain;
    width: 100%;
}
.qty-btn {
    padding: 2px 12px;
    font-size: 18px;
    border: 1px solid #ccc;
    background: #f8f9fa;
    cursor: pointer;
    border-radius: 6px;
    text-decoration: none;
    color: #000;
}
</style>

<div class="cart-wrapper">


    <div class="cart-card">

        <img src="{{ item.product.image.url }}" class="fixed-img">

        <h5 class="mt-3 text-center">
            {{ item.product.name|upper }}
        </h5>

        <p class="text-muted text-center">
            {{ item.product.description|default:"No description available." }}
        </p>

        <!-- QUANTITY -->
        <div class="d-flex justify-content-center align-items-center gap-3 my-3">
            <a href="{% url 'decrease_qty_buy' item.id %}?next=buy_now"
               class="qty-btn">−</a>

            <span class="px-3 fw-bold">{{ item.quantity }}</span>

            <a href="{% url 'increase_qty_buy' item.id %}?next=buy_now"
               class="qty-btn">+</a>
        </div>

        <p class="fw-bold text-center">
            Price: ₹{{ item.total }}
        </p>

        <!-- ACTIONS -->
        <div class="d-flex justify-content-center gap-2 mt-4">
            

            {% if item.product.stock > 0 %}
            <a href="{% url 'order_confirm' %}"
               class="btn btn-success btn-sm w-50">
                Buy Now
            </a>
            {% else %}
            <button class="btn btn-secondary btn-sm w-50" disabled>
                Buy Now
            </button>
            {% endif %}
        </div>

        {% if item.product.stock == 0 %}
        <p class="text-danger fw-bold text-center mt-3">
            Out of Stock
        </p>
        {% endif %}

    </div>

</div>

<script>
setTimeout(function () {
    const alertBox = document.getElementById("stock-alert");
    if (alertBox) {
        alertBox.style.display = "none";
    }
}, 2000);
</script>

{% endblock content %}
